/**
 * @license
 *-------------------------------------------------------------------------------------------
 * Copyright Â© 2025 Progress Software Corporation. All rights reserved.
 * Licensed under commercial license. See LICENSE.md in the package root for more information
 *-------------------------------------------------------------------------------------------
 */
"use strict";var o=Object.defineProperty;var c=(n,t,i)=>t in n?o(n,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):n[t]=i;var h=(n,t,i)=>c(n,typeof t!="symbol"?t+"":t,i);const r=require("./utils.js");class g{constructor(){h(this,"containerHeight",0);h(this,"skip",0);h(this,"total",0);h(this,"enabled",!1);h(this,"pageSize",0);h(this,"itemHeight",0);h(this,"prevScrollPos",0);h(this,"listTranslate",0);h(this,"scrollSyncing",!1);h(this,"scrollerRef",t=>{this.container=t,t&&(t.setAttribute("unselectable","on"),setTimeout(()=>this.calcScrollElementHeight,0))});h(this,"calcScrollElementHeight",()=>{var l;this.scrollSyncing=!0;let t=!1;const i=(l=this.container)==null?void 0:l.children[0],e=i?Array.from(i.children):[];this.itemHeight=e[0]?e[0].offsetHeight:this.itemHeight;const s=this.itemHeight*(this.total-e.length);this.containerHeight=r.firefox?Math.min(r.firefoxMaxHeight,s):s;const a=this.containerHeight;return this.scrollElement&&(t=this.scrollElement.style.height!==a+"px",t&&(this.scrollElement.style.height=a+"px")),this.scrollSyncing=!1,t});this.scrollHandler=this.scrollHandler.bind(this)}get translate(){return this.listTranslate}changePage(t,i){const e=Math.min(Math.max(0,t),this.total-this.pageSize);e!==this.skip&&this.PageChange({skip:e,take:this.pageSize},i)}translateTo(t){this.listTranslate=t,this.list&&(this.list.style.transform="translateY("+t+"px)")}reset(){this.container&&(this.calcScrollElementHeight(),this.container.scrollTop=0,this.translateTo(0))}scrollToEnd(){this.container&&this.list&&(this.calcScrollElementHeight(),this.container.scrollTop=this.container.scrollHeight-this.container.offsetHeight,this.translateTo(Math.min(this.container.scrollHeight,this.containerHeight)))}localScrollUp(t){const i=this.itemHeight,e=this.container.scrollTop;let s=this.listTranslate,a,l=e-s;if(!(l>i)){for(a=0;a<this.skip&&!(s+i+l<=e);a++)s-=i;if(s=this.validateTranslate(s),this.skip-a<=0&&s>=e){this.translateTo(0),this.changePage(0,t),this.container.scrollTop=0;return}s!==this.listTranslate&&(this.translateTo(s),this.changePage(this.skip-a,t))}}localScrollDown(t){const i=this.itemHeight;let e=this.container.scrollTop,s=this.listTranslate;const a=this.list.children.length;let l;for(l=0;l<a&&!(s+i>=e);l++)s+=i;s=this.validateTranslate(s),l>=a&&this.skip+l>=this.total?(this.translateTo(s),this.changePage(this.total-1,t)):s!==this.listTranslate&&(this.translateTo(s),this.changePage(this.skip+l,t))}scrollNonStrict(t){const i=this.containerHeight?this.total*this.prevScrollPos/this.containerHeight:0,e=Math.min(Math.floor(i),this.total-1);let s=this.containerHeight*i/this.total;s=this.validateTranslate(s),this.translateTo(s),this.changePage(e,t)}scrollHandler(t){const i=this.container?this.container.scrollTop:0,e=this.prevScrollPos;this.prevScrollPos=i,this.ScrollChange(t),!(!this.enabled||!this.list||!this.container||this.scrollSyncing)&&(i-e<=0&&i>this.listTranslate-this.list.scrollHeight/10?this.localScrollUp(t):i-e>0&&i<this.listTranslate+this.list.scrollHeight*2/3?this.localScrollDown(t):this.scrollNonStrict(t))}validateTranslate(t){return t=Math.max(0,t),t=Math.min(this.containerHeight,t),t}}module.exports=g;
